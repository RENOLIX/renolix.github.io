<!-- bottom-nav.html -->
<style>
  :root{ --gold:#d4af37; --gold2:#ffd700; --ink:#222; --glass:rgba(255,255,255,0.92); }
  body { padding-bottom: calc(88px + env(safe-area-inset-bottom)); }

  .bottom-nav{
    position:fixed; left:50%; transform:translateX(-50%);
    bottom: calc(10px + env(safe-area-inset-bottom));
    width:min(900px, calc(100% - 20px));
    height:68px;
    display:grid; grid-template-columns:repeat(4,1fr);
    background:var(--glass); backdrop-filter:blur(12px);
    border:2px solid var(--gold); border-radius:18px;
    box-shadow:0 10px 25px rgba(0,0,0,0.22);
    z-index:1100;
  }
  .bn-item{
    display:flex; flex-direction:column; align-items:center; justify-content:center; gap:4px;
    text-decoration:none; color:var(--ink); font-weight:700; font-size:12px; letter-spacing:.2px;
    -webkit-tap-highlight-color:transparent; transition:transform .15s ease;
  }
  .bn-item:active{ transform:translateY(1px); }
  .bn-icon svg{ width:22px; height:22px; fill:#666; transition:transform .2s ease, filter .2s ease, fill .2s ease; }
  .bn-item:hover .bn-icon svg{ filter:drop-shadow(0 0 8px rgba(212,175,55,.5)); transform:translateY(-2px); }

  .bn-item.active .bn-icon svg,
  .bn-item.active .bn-label{ color:var(--gold); fill:var(--gold); }

  .bn-cta{
    margin:8px; border-radius:14px;
    background:linear-gradient(90deg,var(--gold),var(--gold2));
    box-shadow:0 0 12px rgba(212,175,55,.55), inset 0 1px 0 rgba(255,255,255,.4);
    color:#fff;
  }
  .bn-cta .bn-icon svg{ fill:#fff; }
  .bn-cta .bn-label{ color:#fff; }

  @media (prefers-reduced-motion: reduce){
    .bn-item,.bn-icon svg{ transition:none !important; }
  }
</style>

<nav class="bottom-nav" role="navigation" aria-label="Navigation inférieure">
  <!-- ton code nav ici, inchangé -->
</nav>

<script>
  (function(){
    function setActive(){
      var path = (location.pathname || "").toLowerCase();
      document.querySelectorAll('.bottom-nav .bn-item').forEach(function(a){
        var route = (a.getAttribute('data-route')||"").toLowerCase();
        if(!route) return;
        if(path.endsWith(route) || (route==='index.html' && (path.endsWith('/') || path===''))){
          a.classList.add('active');
        }
      });
    }
    setActive();

    function guardAuthLink(e){
      var href = e.currentTarget.getAttribute('href');
      e.preventDefault();
      if(window._sb && window._sb.auth && window._sb.auth.getUser){
        window._sb.auth.getUser().then(({data:{user}})=>{
          if(user){ location.href = href; }
          else{
            var next = encodeURIComponent(href);
            location.href = 'login.html?next='+next;
          }
        }).catch(()=>{ location.href = 'login.html'; });
      }else{
        var next = encodeURIComponent(href);
        location.href = 'login.html?next='+next;
      }
    }
    document.querySelectorAll('.bottom-nav .bn-item[data-auth="required"]').forEach(function(a){
      a.addEventListener('click', guardAuthLink);
    });

    function updateProfileLink(){
      var a = document.getElementById('bn-profile');
      var lbl = document.getElementById('bn-profile-label');
      if(!a || !lbl) return;

      if(window._sb && window._sb.auth && window._sb.auth.getUser){
        window._sb.auth.getUser().then(({data:{user}})=>{
          if(user){
            a.setAttribute('href','profil.html');
            lbl.textContent = 'Profil';
            a.removeAttribute('data-auth');
          }else{
            a.setAttribute('href','login.html');
            lbl.textContent = 'Se connecter';
            a.setAttribute('data-auth','required');
          }
        }).catch(()=>{/* silencieux */});
        if(window._sb.auth.onAuthStateChange){
          window._sb.auth.onAuthStateChange(updateProfileLink);
        }
      }else{
        a.setAttribute('href','login.html');
        lbl.textContent = 'Se connecter';
        a.setAttribute('data-auth','required');
      }
    }
    updateProfileLink();
  })();
</script>